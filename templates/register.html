
<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è | GlobalInvest</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="static/css/register.css">
</head>
<body class="light-theme">
  <script>
    // –£–¥–∞–ª–µ–Ω–∏–µ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥
    document.addEventListener("DOMContentLoaded", () => {
      const flash = document.querySelector(".flash-message");
      if (flash) {
        setTimeout(() => {
          flash.style.opacity = '0';
          setTimeout(() => flash.remove(), 500);
        }, 5000);
      }
    });
  </script>
  {% with messages = get_flashed_messages() %}
    {% if messages %}
      {% for msg in messages %}
        <div class="flash-message" onclick="this.remove()">{{ msg }}</div>
      {% endfor %}
    {% endif %}
  {% endwith %}
  <div class="ticker-wrapper">
    <div class="ticker-line">Apple ‚Ä¢ Google ‚Ä¢ Tesla ‚Ä¢ Bitcoin ‚Ä¢ Ethereum ‚Ä¢ USD ‚Ä¢ EUR ‚Ä¢ Microsoft ‚Ä¢ Amazon ‚Ä¢ Meta ‚Ä¢</div>
    <div class="ticker-line">Binance ‚Ä¢ Visa ‚Ä¢ Mastercard ‚Ä¢ –ì–∞–∑–ø—Ä–æ–º ‚Ä¢ –°–±–µ—Ä–±–∞–Ω–∫ ‚Ä¢ Litecoin ‚Ä¢ Tether ‚Ä¢ Solana ‚Ä¢</div>
  </div>

  <button class="theme-toggle" onclick="toggleTheme()">üåô –¢–µ–º–∞</button>

  <div class="container">
    <div class='form-card'>
      <h2>–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</h2>
      <form method="POST" onsubmit="return validateForm(event)">
        <label>
          –ò–º—è (A-Z):
          <input type="text" name="first_name" required pattern="[A-Za-z]+" placeholder="Alexey">
          <div class="error-message"></div>
        </label>
        <label>
          –§–∞–º–∏–ª–∏—è (A-Z):
          <input type="text" name="last_name" required pattern="[A-Za-z]+" placeholder="Makarov">
          <div class="error-message"></div>
        </label>
        <label>
          –¢–µ–ª–µ—Ñ–æ–Ω:
          <input type="text" name="phone" required placeholder="+79991112233">
          <div class="error-message" id="phoneError"></div>
        </label>
        <label>
          Email:
          <input type="email" name="email" required placeholder="you@example.com">
          <div class="error-message"></div>
        </label>
        <label>
          –ü–∞—Ä–æ–ª—å:
          <input type="password" name="password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
          <div class="error-message" id="passwordError"></div>
        </label>
        <button type="submit">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </form>
      <label class='already-reg'>
        <p>–£–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã ?
          <a href="{{ url_for('login') }}">–í–æ–π—Ç–∏</a>
        </p>
      </label>
    </div>
  </div>

  <div class="modal" id="userExistsModal">
    <h3>–≠—Ç–æ—Ç email —É–∂–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω</h3>
    <p>–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥—Ä—É–≥–æ–π email –∏–ª–∏ –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç.</p>
    <button onclick="closeModal()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>

  <script>
    function toggleTheme() {
      const body = document.body;
      const isDark = body.classList.toggle('dark-theme');
      body.classList.toggle('light-theme', !isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    (function loadTheme() {
      const theme = localStorage.getItem('theme');
      if (theme === 'dark') {
        document.body.classList.add('dark-theme');
        document.body.classList.remove('light-theme');
      }
    })();

    function validateForm(event) {
      let isValid = true;

      const phoneInput = document.querySelector('input[name="phone"]');
      const passwordInput = document.querySelector('input[name="password"]');
      const phoneError = document.getElementById('phoneError');
      const passwordError = document.getElementById('passwordError');

      const phoneRegex = /^\+7\d{10}$/;
      if (!phoneRegex.test(phoneInput.value)) {
        phoneError.textContent = '–í–≤–µ–¥–∏—Ç–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ +7XXXXXXXXXX';
        phoneInput.classList.add('error');
        isValid = false;
      } else {
        phoneError.textContent = '';
        phoneInput.classList.remove('error');
      }

      
      if (passwordInput.value.length < 8) {
        errorMessage = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å –º–∏–Ω–∏–º—É–º 8 —Å–∏–º–≤–æ–ª–æ–≤.';
      } if (!/[A-Z]/.test(passwordInput.value)) {
        errorMessage = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –∑–∞–≥–ª–∞–≤–Ω—É—é –±—É–∫–≤—É.';
      } else if (!/[0-9]/.test(passwordInput.value)) {
        errorMessage = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É —Ü–∏—Ñ—Ä—É.';
      } else if (!/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?`~]/.test(passwordInput.value)) {
        errorMessage = '–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π —Å–∏–º–≤–æ–ª.';
      } else {
        errorMessage = false;
      }
      

      if (errorMessage != false) {
        passwordError.textContent = errorMessage;
        passwordInput.classList.add('error');
        isValid = false;
      } else {
        passwordError.textContent = '';
        passwordInput.classList.remove('error');
      }

      const existingUsers = ['you@example.com'];
      const emailInput = document.querySelector('input[name="email"]');
      if (existingUsers.includes(emailInput.value)) {
        showModal();
        isValid = false;
      }

      return isValid;
    }

    function showModal() {
      document.getElementById('userExistsModal').classList.add('show');
    }

    function closeModal() {
      document.getElementById('userExistsModal').classList.remove('show');
    }
  </script>
</body>
</html>
